07 문자/숫자/날짜 함수
문자함수
예제01 SELECT ID, NAME, LOWER(NAME) AS NAME_SMALL FROM VENDOR_INFO;
예제02 SELECT ID, NAME, UPPER(NAME) AS NAME_CAP FROM VENDOR_IFNO;
예제03 SELECT ID, NAME, LENGTH(NAME) AS NAME_CNT FROM VENDOR_INFO;
예제04 SELECT ID, NAME, SUBSTR(NAME,1,3) AS NAME_STR FROM VENDOR_INFO;
숫자함수
ROUND TRUNC MOD(M,N) ABS SIGN SQRT COS SIN SAN PI
ROUND TRUNC MOD(M,N)
SELECT PROD_ID, TOTAL_SALES, ROUND(TOTAL_SALES,2) AS SALESS_REV FROM PROD_SALES; #1임
SELECT PROD_ID, TOTAL_SALES, ROUND(TOTAL_SALES, 0) AS SALES_REV FROM PROD_SALES;
SELECT PROD_ID, TOTAL_SALES, ROUND(TOTAL_SALES, -2) #-1임 
SELECT PROD_ID, TOTAL_SALES, SALES_NUM, MOD(TOTAL_SALES,SALES_NUM) AS SALES_BALANCE FROM PROD_SALES;
SELECT PROD_ID, ECON_INCOME, ABS(ECON_INCOME) AS PRFT FROM PROD_SALES;

실습
01 SELECT RESIENCE_ID, (RESIDENCE_ID LIKE 8% = 1, RESIDENCE_ID LIKE 7% = 2) AS GENDER FROM CUST_INFO;
SUBSTR(RESIDENCE_ID, 1)
#SUBSTR(RESIDENCE_ID,7,1)
02 SELECT TRIM(LAST_NM)||', '||TRIM(FIRST_NM) AS FLL_NM FROM CUST_INFO;
03 SELECT RESIDENCE_ID, ROUND(ANNL_PERF,1) AS NEW_ANNL_PERF FROM CUST_INFO;

08
case when then
02 SELECT ID, JOB, CURRNET_SAL, ENG_SCORE
        CASE WHEN JOB='CLERK' AND ENG_SCORE >= 80 THEN CURRENT_SAL*10.7
             WHEN JOB='CLERK' AND ENG_SCORE < 80  THEN CURRENT_SAL*1.06
             WHEN JOB='OFFICIER' AND ENG_SCORE >= 80 THEN CURRENT_SAL*1.05
             WHEN JOB='OFFICIER' AND ENG_SCORE < 80  THEN CURRENT_SAL*1.04
             WHEN JOB='MANAGER' AND ENG_SCORE >= 80  THEN CURRENT_SAL*1.03
             WHEN JOB='MANAGER' AND ENG_SCORE < 80  THEN CURRENT_SAL*1.02
             ELSE CURRENT_SAL
             END AS NEXT_SAL
   FROM STAFF_SAL;

03 SELECT SUM(NEXT_SAL
        CASE WHEN JOB='CLERK' AND ENG_SCORE >= 80 THEN CURRENT_SAL*10.7
             WHEN JOB='CLERK' AND ENG_SCORE < 80  THEN CURRENT_SAL*1.06
             WHEN JOB='OFFICIER' AND ENG_SCORE >= 80 THEN CURRENT_SAL*1.05
             WHEN JOB='OFFICIER' AND ENG_SCORE < 80  THEN CURRENT_SAL*1.04
             WHEN JOB='MANAGER' AND ENG_SCORE >= 80  THEN CURRENT_SAL*1.03
             WHEN JOB='MANAGER' AND ENG_SCORE < 80  THEN CURRENT_SAL*1.02
             ELSE CURRENT_SAL END 
             AS NEXT_SAL ) - SUM(CURRENT_SAL) AS ADD_BUDGET
  FROM STAFF_SAL;
# SUM ( NEXT SAL CASE WHEN... 에서 NEXT SAL 을 정의할 필요가 없었다 해야하나 . 그리고 없는 문법 같음

실습01
SELECT CUST_ID, CUST_SEG, BALANCE_201311, BALANCE_201312,
        CASE WHEN BALANCE_201311*1.1<=BALANCE_201312 THEN 1
             ELSE 0 END AS OFFER_ACCEPT
FROM CASA_201312;

실습02
SELECT COUNT(*) AS LEAD_CNT, 
        SUM(CASE WHEN BALANCE_201311*1.1<=BALANCE_201312 THEN 1 ELSE 0 END) AS OFFER_ACCEPT, 
        OFFER_ACCEPT/LEAD_CNT*100 AS RES_RATE
FROM CASA_201312;

실습03
SELECT SUM(BALANCE_201311)AS BAL_1311, SUM(BALANCE_201312) AS BAL_1312, (SUM(BALANCE_201312)-SUM(BALANCE_201311)) AS INC_BAL, SUM(BALANCE_201311)*0.9 AS REV
FROM CASA_201312;
?

09
예제1
01
SELECT SEG, SUM(CASE WHEN SEG='DIAMOND' THEN ANNL_REV WHEN SEG='GOLD' THEN ANNL_
NO
SELECT GENDER, AVG(ENG) AS ENG_SCORE, AVG(MATH) AS MATH_SCORE
SELECT SEG, AVG(ANNL_REV)
FROM PPC_201312
GROUP BY SEG;

02 
SELECT SEG, COUNT(CUST_ID) AS CNT, SUM(CARD_FLG) AS CARD_FLG
FROM PPC_201312
GROUP BY SEG;

03
SELECT CARD_FLG, LOAN_FLG,
        SUM(CASE WHEN CARD_FLG=0 AND LOAN_FLG=0 THEN 1,
                 WHEN CARD_FLG=1 AND LOAN_FLG=0 THEN 1,
                 WHEN CARD_FLG=1 AND LOAN_FLG=0 THEN 1,
                 ELSE 0 END) AS CNT
FROM PPC_201312 
GROUP BY CARD_FLG, LOAN_FLG;
GROUP BY 1,2;

실습
01
SELECT CASE WHEN ADD_CD IN (100,110,120,130,140) THEN ASSET
            WHEN ADD_CD IN (300,310,320,330,340) THEN LIABILITY
        END AS BALANCE_SHEET,
        SUM(BALANCE_AMT) AS TOTAL_BALANCE_AMT
FROM PPC_MAST_201312
GROUP BY 1;

02
SELECT SSN, COUNT(*) AS CNT
FROM PPC_MAST_201312
GROUP BY SSN;

03
SELECT SSN, COUNT(*) AS PPC
FROM PPC_MAST_201312
GROUP BY SSN
HAVING COUNT(*)>2
ORDER BY 1;

04 
SELECT SSN, COUNT(*) AS PPC, SUM(PRFT) AS PRFT)
FROM PPC_MAST_201312
GROUP BY 1
ORDER BY 1;


SELECT SEG, COUNT(*) AS CNT, SUM(CARD_FLG) AS CARD_CNT
GROUP BY SEG


